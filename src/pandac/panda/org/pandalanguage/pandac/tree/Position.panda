package org.pandalanguage.pandac.tree

class Position : panda.core.Value {
    constant INTERNAL := new Position("<internal>", -1, -1)

    def compilationUnit:String

    def line:Int

    def column:Int
    
    constructor(compilationUnit:String, line:Int, column:Int) {
        self.compilationUnit := compilationUnit
        self.line := line
        self.column := column
    }
    
    @override
    @preOr(fmt = "line")
    function format(fmt:String):String {
        if fmt = "line"
            return compilationUnit + ":" + line
        return compilationUnit + ":" + line + ":" + column
    }
    
    @override
    function =(o:Object):Bit {
        if o-?>(Position) {
            var p := o->(Position)
            return compilationUnit = p.compilationUnit & line = p.line &
                    column = p.column
        }
        return false
    }

    @override
    @math(overflow)
    function hash():Int {
        return compilationUnit.hash ~~ line ~~ (column * 1000)
    }
}