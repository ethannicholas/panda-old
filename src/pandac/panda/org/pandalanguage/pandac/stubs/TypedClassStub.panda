package org.pandalanguage.pandac.stubs

uses org.pandalanguage.pandac.compiler.LookupContext
uses org.pandalanguage.pandac.parser.ParseNode
uses org.pandalanguage.pandac.tree.Annotations
uses org.pandalanguage.pandac.tree.Position
uses org.pandalanguage.pandac.types.ClassType
uses org.pandalanguage.pandac.types.GenericParameterType
uses org.pandalanguage.pandac.types.Type

================================================================================
Represents a parsed but not-yet-compiled class after symbol resolution.
================================================================================
class TypedClassStub : ClassStub {
    def superclass:ClassType?

    def interfaces:ImmutableArray<ClassType>

    def methods:ImmutableArray<TypedMethodStub>

    def fields:ImmutableArray<TypedFieldStub>

    def genericParameters:ImmutableArray<GenericParameterType>?

    @invariant(genericParameters = null | genericParameters.length > 0)

    @pre(genericParameters = null | genericParameters.length > 0)
    constructor(position:Position, name:String, isInterface:Bit, 
            annotations:Annotations, lookupContext:LookupContext, 
            superclass:ClassType?, interfaces:ListView<ClassType>, 
            methods:ListView<TypedMethodStub>, fields:ListView<TypedFieldStub>, 
            invariants:ListView<ParseNode>,
            genericParameters:ListView<GenericParameterType>?, isExternal:Bit) {
        super.constructor(position, name, isInterface, annotations, 
                lookupContext, invariants, isExternal)
        self.superclass := superclass
        self.interfaces := new ImmutableArray<ClassType>(interfaces)
        self.methods := new ImmutableArray<TypedMethodStub>(methods)
        self.fields := new ImmutableArray<TypedFieldStub>(fields)
        if genericParameters != null {
            self.genericParameters := new ImmutableArray<GenericParameterType>(
                    genericParameters)
        }
    }

    @override
    function format(fmt:String):String {
        return "\{name}(\{fields}, \{methods})"
    }
}